---
title: "什么是模态窗口？本文带你了解模态窗口的本质"
publishDate: 2019-10-07 20:38:04 +0800
date: 2019-10-08 09:24:47 +0800
categories: windows dotnet csharp wpf
position: knowledge
---

做 Windows 桌面应用开发的小伙伴们对“模态窗口”（Modal Dialog）一定不陌生。如果你希望在模态窗口之上做更多的事情，或者自己实现一套模态窗口类似的机制，那么你可能需要了解模态窗口的本质。

本文不会太深，只是从模态窗口一词出发，抵达大家都熟知的一些知识为止。

---

<div id="toc"></div>

## 开发中的模态窗口

在各种系统、语言和框架中，只要有用户可以看见的界面，都存在模态窗口的概念。从交互层面来说，它的形式是在保留主界面作为环境来显示的情况下，打开一个新的界面，用户只能在新的界面上操作，完成或取消后才能返回主界面。从作用上来说，通常是要求用户必须提供某些信息后才能继续操作，或者单纯只是为了广告。

## 模态窗口的三个特点

如果你希望自己搞一套模态窗口出来，那么只需要满足这三点即可。你可以随便加戏但那都无关紧要。

1. 保留主界面显示的同时，禁用主界面的用户交互；
2. 显示子界面，主界面在子界面操作完成后返回；
3. 当用户试图跳过子界面的交互的时候进行强提醒。

拿 Windows 系统中的模态对话框为例子，大概就像下面这两张图片这样：

有一个小的子界面盖住了主界面，要求用户必须进行选择。Windows 系统设置因为让背景变暗了，所以用户肯定会看得到需要进行的交互；而任务管理器没有让主界面变暗，所以用户在操作子界面的时候，模态窗口的边框和标题栏闪烁以提醒用户注意。

![Windows 系统设置](/static/posts/2019-10-08-09-01-47.png)

![任务管理器](/static/posts/2019-10-08-modal-dialog-twinkle.gif)

## 实现模态窗口

对于 Windows 操作系统来说，模态窗口并不是一个单一的概念，你并不能仅通过一个 API 调用就完成显示模态窗口，你需要在不同的时机调用不同的 API 来完成一个模态窗口。如果要完整实现一个自己的模态窗口，则需要编写实现以上三个特点的代码。

当然，你可能会发现实际上你显示一个模态窗口仅仅一句话调用就够了，那是因为你所用的应用程序框架帮你完成了模态窗口的一系列机制。

关于 WPF 框架是如何实现模态窗口的，可以阅读：[直击本质：WPF 框架是如何实现模态窗口的](/post/how-does-wpf-implement-modal-dialog.html)

关于如何自己实现一个跨越线程/进程边界的模态窗口，可以阅读：[实现 Windows 系统上跨进程/跨线程的模态窗口](/post/implement-own-modal-dialogs-across-processes-or-threads.html)

如果你希望定制以上第三个特点中强提醒的动画效果，可以阅读：[WPF window 子窗口反馈效果（抖动/阴影渐变) - 唐宋元明清2188 - 博客园](https://www.cnblogs.com/kybs0/p/7357759.html)。
