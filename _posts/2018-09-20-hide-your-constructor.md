---
title: "只有你能 new 出来！.NET 隐藏构造函数的 n 种方法（Builder Pattern / 构造器模式）"
date: 2018-09-20 17:39:03 +0800
categories: dotnet csharp
published: false
---

如果你给类写了一个公有构造函数，那么这个类就能被其他开发者 new 出来。如果你不想让他们 new 出来，把构造函数 `private` 就好了呀。

然而还有更多奇怪的方式来隐藏你类的构造方法。

---

<div id="tic"></div>

### 为什么要隐藏构造函数？

有些类型，只有组件的设计者才知道如何正确创建其类型的实例，多数开发者都无法正确将其创建出来。典型的如 `string`：绝大多数开发者都不能正确创建出 `string` 的实例，但通过写一个字符串由编译器去创建，或者使用 `StringBuilder` 来构造则不容易出错。

再或者，我们只希望开发者使用到某个抽象的实例，而不是具体的类型，那么这个时候开发者也需要有方法能够拿到抽象接口的实例。我们可能会使用工厂或者某些其他的方法让开发者在不知道具体类型的时候获取到抽象类型的实例。

这正是构造器模式的典型应用场景。在维基百科中对它适用性的描述为：

> 在以下情况使用生成器模式：
> 
> - 当创建复杂对象的算法应该独立于该对象的组成部分以及它们的装配方式时；
> - 当构造过程必须允许被构造的对象有不同的表示时。

详见：[生成器模式 - 维基百科，自由的百科全书](https://zh.wikipedia.org/wiki/%E7%94%9F%E6%88%90%E5%99%A8%E6%A8%A1%E5%BC%8F)

接下来，我们使用一些奇怪的方式来创建对象的实例，完完全全把构造函数隐藏起来。

### 